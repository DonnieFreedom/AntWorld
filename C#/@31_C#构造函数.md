# C#构造函数

在 C# 中，**构造函数**就是与类（或结构体）具有相同名称的**成员函数**，当创建一个类的对象时会自动调用类中的构造函数。在程序开发的过程中，我们通常使用类中的构造函数来初始化类中的成员属性。

C# 中的构造函数有三种：

- 实例构造函数；
- 静态构造函数；
- 私有构造函数。是一种特殊的实例构造函数

### 实例构造函数

它的名称与它所在类的名称相同，并且**没有返回值**。

使用 new 关键字创建类的对象时，可以使用实例构造函数来创建和初始化类中的任意成员属性

只要创建类的对象，就会调用该类中的实例构造函数, 在实例化对象时将具体的值传递给类中的构造函数即可

如果没有为类显式的创建构造函数，那么 C# 将会为这个类隐式的创建一个没有参数的构造函数（无参数构造函数）, 这个无参的构造函数会在实例化对象时为类中的成员属性设置默认值;

在结构体中也是如此，如果没有为结构体创建构造函数，那么 C# 将隐式的创建一个无参数的构造函数，用来将每个字段初始化为其默认值。

### 静态构造函数

若要初始化静态类或非静态类中的静态属性，则需要使用静态构造函数。

静态构造函数用于初始化类中的静态数据或执行仅需执行一次的特定操作。

静态构造函数将在创建第一个实例或引用类中的静态成员之前自动调用。

静态构造函数具有以下特性：

- 静态构造函数不使用访问权限修饰符修饰或不具有参数；
- 类或结构体中只能具有一个静态构造函数；
- 静态构造函数不能继承或重载；
- 静态构造函数不能直接调用，仅可以由公共语言运行时 (CLR) 调用；
- 用户无法控制程序中静态构造函数的执行时间；
- 在创建第一个实例或引用任何静态成员之前，将自动调用静态构造函数以初始化类；
- 静态构造函数会在实例构造函数之前运行。

```C#
using System;
namespace c.sharp
{
    class Demo
    {
        public static int num = 0;
        // 构造函数
        Demo(){
            num = 1;
        }
        // 静态构造函数
        static Demo(){
			Console.WriteLine("num = {0}", num);
            num = 2;
			Console.WriteLine("num = {0}", num);
        }
        static void Main(string[] args) 
        {
			Demo2 Obj2 = new Demo2();
			Demo Obj = new Demo();
            Console.WriteLine("num = {0}", num);
            Console.Read();
        }
    }
	class Demo2
    {
        public static int num2 = 3;
		public static int num3;

        // 静态构造函数
        static Demo2(){
            Console.WriteLine("num3 = {0}", num3);
			Console.WriteLine("num2 = {0}", num2);
            num2 = 4;
			Console.WriteLine("num2 = {0}", num2);
        }
	}
}

/*
num = 0
num = 2
num3 = 0	# 
num2 = 3
num2 = 4
num = 1
若main方法中没有语句:
num = 0
num = 2
*/
```

### 私有构造函数

私有构造函数通常用在只包含静态成员的类中。

如果一个类中具有一个或多个私有构造函数而没有公共构造函数的话，那么其他类（除嵌套类外）则无法创建该类的实例。

如果不对构造函数使用访问权限修饰符，则默认它为私有构造函数。

一个空的私有构造函数, 可阻止自动生成无参数构造函数。

原因如下:

```C#
/*
A member 'c.sharp.Student.Student(string)' is already defined. Rename this member or use different parameter types
即显式定义:
*/
private Student() { }
public Student() { }
// 或
Student(string name) { }
public Student(string name) { }
/*
会抛出以上错误
故:
改变参数类型或重命名成员函数名以解决此问题
*/
```

原因:  即和一起定义会抛出以上错误

```C#
using System;
namespace c.sharp
{
    class Demo
    {
        static void Main(string[] args) 
        {
            // Student stu = new Student();
            Student.id = 101;
            Student.name = "张三";
            Student.Display();
            Console.Read();
        }
    }
    public class Student
    {
        private Student() { }
        public static int id;
        public static string name;
        public static void Display()
        {
            Console.WriteLine("姓名："+name+" 编号："+id);
        }
    }
}

/*
姓名：张三 编号：101
*/
```

